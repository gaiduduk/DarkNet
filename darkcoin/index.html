<style>

    .cell {
        border-bottom: 1px solid black;
        border-right: 1px solid black;
        text-align: center;
        padding: 16px 0;
    }

    .buy-sale-delimiter {
        width: 4px;
        background-color: rgb(33, 150, 243);
    }

</style>
<div class="layout-fill layout-column layout-align-center-center ng-cloak"
     style="background: url(img/background.png) center center no-repeat;" ng-show="token == null">
    <form class="input-wrapper layout-column" ng-submit="loginButton()">
        <div class="input-header layout-row layout-align-center">
            <h3>{{userToken != null ? "Verification" : toggleLoginReg ? "Authorization" : "Registration"}}</h3>
        </div>
        <md-content class="input-container layout-column" ng-show="toggleLoginReg == true">
            <md-input-container>
                <input type="email" ng-model="login" ng-required="true" placeholder="Email">
            </md-input-container>
            <md-input-container>
                <input type="password" ng-model="password" ng-required="true" minlength="8" placeholder="Password">
            </md-input-container>
            <div class="div" ng-show="login_message" style="color: rgb(33, 150, 243);">{{login_message}}</div>
            <div class="layout-row">
                <md-button class="flex-40 md-raised" ng-click="toggleLoginReg = false"
                           ng-disabled="login_request_in_progress">
                    Sign Up
                </md-button>
                <div class="flex"></div>
                <div class="layout-column flex-40">
                    <md-button type="submit" class="md-raised md-primary" ng-disabled="login_request_in_progress">
                        Sign In
                        <md-progress-linear md-mode="query"
                                            ng-disabled="!login_request_in_progress"></md-progress-linear>
                    </md-button>
                </div>
            </div>
        </md-content>
        <md-content class="input-container layout-column" ng-show="toggleLoginReg == false">
            <md-input-container>
                <input type="email" ng-model="login" ng-required="true" placeholder="Email">
            </md-input-container>
            <md-input-container>
                <input type="password" ng-model="password" ng-required="true" minlength="8" placeholder="Password">
            </md-input-container>
            <md-checkbox ng-model="agreeWithTeems" class="md-align-top-left" required>
                I agree to <a href="terms.html" target="_blank">the terms of use</a>
            </md-checkbox>
            <div class="layout-column">
                <md-button type="submit" ng-disabled="!agreeWithTeems && !login_request_in_progress" class="md-raised">
                    Sign Up
                    <md-progress-linear md-mode="query" ng-disabled="!login_request_in_progress"></md-progress-linear>
                </md-button>
            </div>
            <div class="div" ng-show="login_message" style="color: rgb(33, 150, 243);">{{login_message}}</div>
        </md-content>
        <md-content class="input-container layout-column layout-align-center-center" ng-show="userToken != null">
            <md-button class="md-fab" style="width: 100px; height: 100px">
                <md-icon style="width: 100px; height: 100px" md-svg-src="img/success.svg"></md-icon>
            </md-button>
            <h1>Successful</h1>
            <span>redirecting ...</span>
        </md-content>
    </form>
</div>


<div class="layout-fill layout-row ng-cloak" style="background-color: #666666;" ng-show="token != null">
    <md-content class="layout-column flex-gt-xs-25 flex" ng-show="windowWidth >= 600 || activeWindow == 0">
        <div class="layout-column flex scrollable" ng-show="toggleSendFragment">
            <div class="layout-column" style="background-color: #444444;">
                <div class="layout-column"
                     style="padding: 20px; background-image: url(img/wallet_background.jpg); background-size: 100% 100%;">
                    <div class="layout-row">
                        <md-button ng-click="logout()">LogOut</md-button>
                        <div class="flex"></div>
                        <md-button class="md-fab md-mini hide-gt-xs"
                                   ng-click="activeWindow = 1">
                            <md-icon md-svg-src="img/next.svg"></md-icon>
                        </md-button>
                    </div>
                    <div class="layout-column layout-align-center-center" style="height: 200px">
                        <h1>{{hostname}}</h1>
                    </div>
                    <div class="layout-row layout-align-center">
                        <div class="layout-row flex-80">
                            <input id="walletId" class="flex" type="text" ng-value="user_login"
                                   style="border-radius: 10px 0 0 10px; padding-left: 20px;">
                            <md-button class="md-raised md-primary flex" style="border-radius: 0 10px 10px 0;"
                                       ng-click="copyToClipboard()">
                                {{copyButtonLabel}}
                            </md-button>
                        </div>
                    </div>
                </div>
                <md-content class="layout-column layout-align-center-center" style="padding: 16px"
                            ng-show="have_coins == null">You dont have coins yet
                </md-content>
                <md-content class="layout-column" ng-repeat="coin in have_coins">
                    <md-card class="layout-column" style="padding: 16px 16px 16px 24px;" md-ink-ripple
                             ng-click="openCoin(coin.coin_code)">
                        <div class="layout-row">
                            <big><b>{{coin.coin_count + " " + coin.coin_code}}</b></big>
                        </div>
                        <div class="layout-row" style="padding: 8px 0 0 40px">
                            <small style="color: #9e9e9e">{{"1 " + coin.coin_code + " = "
                                + (getRate(coin.coin_code) != null ? round(getRate(coin.coin_code)) + " USD" :
                                "no data")}}</small>
                        </div>
                    </md-card>
                </md-content>
                <md-content class="layout-column">
                    <md-card class="layout-row layout-align-start-center"
                             style="padding: 16px 16px 16px 24px;" md-ink-ripple
                             ng-click="show('create_coin')">
                        <md-icon style="margin: 0 12px 0 0;" md-svg-src="img/add.svg"></md-icon>
                        Create Dark coin
                    </md-card>
                </md-content>
            </div>
        </div>
        <div class="layout-row">
            <md-button class="md-raised md-primary flex header" ng-click="show('send')">
                Send
            </md-button>
        </div>
        <div class="layout-column layout-align-center-center flex" ng-show="!toggleSendFragment"
             style="background-color: #444444">
            <form class="input-wrapper layout-column" ng-submit="send()">
                <div class="input-header layout-row layout-align-center">
                    <h3>Send</h3>
                </div>
                <md-content class="input-container layout-column">
                    <md-input-container>
                        <input type="email" ng-model="send_user_login" required maxlength="256"
                               placeholder="receiver@gmail.com">
                    </md-input-container>
                    <div class="layout-row">
                        <md-input-container>
                            <label>Coin</label>
                            <md-select ng-model="send_coin_code" required>
                                <md-option ng-repeat="coin in have_coins" value="{{coin.coin_code}}">{{coin.coin_code}}
                                </md-option>
                            </md-select>
                        </md-input-container>
                        <md-input-container class="flex">
                            <label>Count</label>
                            <input type="number" ng-model="send_coin_count" required
                                   min="1" max="{{getHaveCoin(send_coin_code)['coin_count']}}">
                        </md-input-container>
                    </div>
                    <div ng-show="send_message != null" style="color: red">{{send_message}}</div>
                    <md-button type="submit" class="md-raised md-primary" style="margin-top: 20px"
                               ng-disabled="send_request_in_progress">
                        Send
                        <md-progress-linear md-mode="query"
                                            ng-disabled="!send_request_in_progress"></md-progress-linear>
                    </md-button>
                </md-content>
            </form>
        </div>
    </md-content>


    <md-content class="layout-column flex" style="background-color: #9e9e9e;"
                ng-show="windowWidth >= 600 || activeWindow == 1">
        <div class="layout-column flex" ng-show="toggleExchangeFragment">
            <div class="layout-row layout-align-center-center header">
                <md-button class="md-fab md-mini hide-gt-xs " ng-click="activeWindow = 0">
                    <md-icon md-svg-src="img/back.svg"></md-icon>
                </md-button>
                <div class="layout-row layout-align-center flex">
                    <h2>Exchange stock</h2>
                </div>
                <md-button class="md-fab md-mini hide-gt-xs " ng-click="activeWindow = 2">
                    <md-icon md-svg-src="img/next.svg"></md-icon>
                </md-button>
            </div>
            <h2 class="layout-column layout-align-center-center" style="padding: 16px"
                ng-show="buyOffers == null && saleOffers == null">There are no exchange offers yet</h2>
            <div class="layout-column flex scrollable" ng-show="buyOffers != null || saleOffers != null">
                <div class="layout-row layout-align-center">
                    <h2 style="position: relative; top: 10px; border: 6px solid rgb(33, 150, 243); background-color: black; padding: 16px;">{{have_coin_code}} : {{want_coin_code}}</h2>
                </div>
                <md-card class="layout-row" style="margin-top: -24px">
                    <div class="layout-column flex-50">
                        <div class="layout-row input-header">
                            <div class="cell flex-33">Sale {{have_coin_code}}</div>
                            <div class="cell flex-33">Want {{want_coin_code}}</div>
                            <div class="cell flex-33">Rate</div>
                        </div>
                        <div class="layout-row" ng-repeat="offer in saleOffers">
                            <div class="cell flex-33" ng-class="{'my-cell': offer.back_user_login == user_login}">
                                {{offer.have_coin_count}}
                            </div>
                            <div class="cell flex-33" ng-class="{'my-cell': offer.back_user_login == user_login}">
                                {{offer.want_coin_count}}
                            </div>
                            <div class="cell flex-33" ng-class="{'my-cell': offer.back_user_login == user_login}">
                                {{round(offer.offer_rate_inverse)}}
                            </div>
                        </div>
                    </div>
                    <div class="layout-column">
                        <div class="flex buy-sale-delimiter"></div>
                    </div>
                    <div class="layout-column flex-50">
                        <div class="layout-row input-header">
                            <div class="cell flex-33">Rate</div>
                            <div class="cell flex-33">Sale {{want_coin_code}}</div>
                            <div class="cell flex-33 ">Want {{have_coin_code}}</div>
                        </div>
                        <div class="layout-row" ng-repeat="offer in buyOffers">
                            <div class="cell flex-33" ng-class="{'my-cell': offer.back_user_login == user_login}">
                                {{round(offer.offer_rate)}}
                            </div>
                            <div class="cell flex-33" ng-class="{'my-cell': offer.back_user_login == user_login}">
                                {{offer.have_coin_count}}
                            </div>
                            <div class="cell flex-33" ng-class="{'my-cell': offer.back_user_login == user_login}">
                                {{offer.want_coin_count}}
                            </div>
                        </div>
                    </div>
                </md-card>

                <md-card class="layout-column">
                    <div class="layout-row layout-align-center input-header" ng-show="haveOffers != null">
                        <h2>My offers</h2>
                    </div>
                    <div class="layout-column" ng-repeat="offer in haveOffers">
                        <md-content class="layout-row" style="padding: 10px" ng-click="openOffer(offer)" md-ink-ripple>
                            <b>{{offer.have_coin_count+ " " + offer.have_coin_code + " ➠ " +
                                offer.want_coin_count + " " + offer.want_coin_code}}</b>
                            <div class="flex"></div>
                            <b>Progress {{offer.offer_progress}}%</b>
                            <div ng-show="windowWidth >= 600" class="flex"></div>
                            <b ng-show="windowWidth >= 600">Rate {{round(offer.offer_rate)}}</b>
                        </md-content>
                        <md-divider></md-divider>
                    </div>
                </md-card>
            </div>
        </div>
        <md-button class="md-raised md-primary header" ng-click="show('exchange')">
            Exchange
        </md-button>
        <div class="layout-column layout-align-center-center flex" ng-show="!toggleExchangeFragment"
             style="background-color: #444444">
            <form class="input-wrapper layout-column" ng-submit="exchange()">
                <div class="input-header layout-row layout-align-center">
                    <h3>Exchange</h3>
                </div>
                <md-content class="input-container layout-column">
                    <div class="layout-row">
                        <div class="layout-column">
                            <md-input-container>
                                <label>Sale</label>
                                <md-select ng-model="offer_have_coin_code" required>
                                    <md-option ng-repeat="coin in have_coins" value="{{coin.coin_code}}">
                                        {{coin.coin_code}}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                            <md-input-container>
                                <input type="number" ng-model="offer_have_coin_count" required maxlength="5"
                                       ng-change="offerHaveCoinCountChange()" placeholder="Count">
                            </md-input-container>
                        </div>
                        <div class="layout-column">
                            <div class="layout-row layout-align-center">
                                <md-button class="md-icon-button" ng-click="exchangeSwapCurrencies()">
                                    <md-icon md-svg-src="img/next.svg"></md-icon>
                                </md-button>
                            </div>
                            <div class="flex"></div>
                            <md-input-container>
                                <input type="number" ng-model="offer_rate" step="0.00000001" required maxlength="10"
                                       ng-change="offerRateChange()" placeholder="Rate">
                            </md-input-container>
                        </div>
                        <div class="layout-column">
                            <md-input-container>
                                <label>Want</label>
                                <md-select ng-model="offer_want_coin_code" required>
                                    <md-option ng-repeat="coin in coins" value="{{coin}}">{{coin}}</md-option>
                                </md-select>
                            </md-input-container>
                            <md-input-container>
                                <input type="number" ng-model="offer_want_coin_count" required maxlength="5"
                                       ng-change="offerWantCoinCountChange()" placeholder="Count">
                            </md-input-container>
                        </div>
                    </div>
                    <div ng-show="exchange_message != null" style="color: red">{{exchange_message}}</div>
                    <md-button type="submit" class="md-raised md-primary" style="margin-top: 20px"
                               ng-disabled="exchange_in_progress">
                        Exchange
                        <md-progress-linear md-mode="query" ng-disabled="!exchange_in_progress"></md-progress-linear>
                    </md-button>
                </md-content>
            </form>
        </div>
    </md-content>


    <md-content class="layout-column flex-gt-md-25 flex" style="background-color: #9e9e9e;"
                ng-show="windowWidth >= 1280 || activeWindow == 2">
        <div class="layout-column flex" ng-show="toggleCreateCoinFragment">
            <div class="layout-row layout-align-start-center header" style="background-color: #666666; ">
                <md-button class="md-fab md-mini hide-gt-xs " ng-click="activeWindow = 1">
                    <md-icon md-svg-src="img/back.svg"></md-icon>
                </md-button>
                <div class="layout-row layout-align-center flex">
                    <h2>Rates</h2>
                </div>
            </div>
            <div class="layout-column layout-align-center-center" style="padding: 16px" ng-show="rates == null">There
                Are no rates yet
            </div>
            <div class="layout-column flex scrollable" ng-show="rates != null">
                <md-card class="layout-column">
                    <div class="layout-row input-header">
                        <div class="cell flex-50">Coin</div>
                        <div class="cell flex-50">Rate</div>
                    </div>
                    <md-content class="layout-row" ng-repeat="rate in rates" ng-click="updateData(rate.coin_code)"
                                md-ink-ripple>
                        <div class="cell flex-50">{{rate.coin_code}}</div>
                        <div class="cell flex-50">{{round(rate.offer_rate)}} USD</div>
                    </md-content>
                </md-card>
            </div>
        </div>
        <md-button class="md-raised md-primary header" ng-click="show('create_coin')">
            Create coin
        </md-button>
        <div class="layout-column layout-align-center-center flex" ng-show="!toggleCreateCoinFragment"
             style="background-color: #444444">
            <form class="input-wrapper layout-column" target="_blank"
                  ng-submit="createCoin()">
                <input type="hidden" name="token" value="{{token}}">
                <div class="input-header layout-row layout-align-center">
                    <h3>Create coin</h3>
                </div>
                <md-content class="input-container layout-column">
                    <md-input-container>
                        <input ng-model="newCoinName" required minlength="3" maxlength="30" placeholder="Full name of Your Coin">
                    </md-input-container>
                    <md-input-container>
                        <input ng-model="newCoinCode" minlength="3" maxlength="5" style="text-transform: uppercase;"
                               required placeholder="Code of Your Coin">
                    </md-input-container>
                    <md-checkbox ng-model="agreeWithPublicationOnExchangeStock">
                        Publication on exchange stock
                    </md-checkbox>

                    <div ng-show="create_coin_message != null" style="color: red">{{create_coin_message}}</div>
                    <md-button type="submit" class="md-raised md-primary"
                               style="margin-top: 20px; background-color: green"
                               ng-disabled="create_coin_request_in_progress">
                        {{agreeWithPublicationOnExchangeStock ? "Create public coin" : "Create coin"}}
                        <md-progress-linear md-mode="query"
                                            ng-disabled="!create_coin_request_in_progress"></md-progress-linear>
                    </md-button>
                </md-content>
            </form>
        </div>
    </md-content>
</div>
<div style="position: absolute; right: 0; bottom: 0; max-width: 100%; padding: 16px" ng-show="messages != null">
    <div class="input-wrapper">
        <div class="input-header layout-row layout-align-center-center" style="padding: 16px">
            <h2 class="layout-row flex" style="margin: 0">{{messages[message_index].message_title}}</h2>
            <md-button class="md-fab md-mini" style="background-color: black" ng-click="messages = null">
                <md-icon md-svg-src="img/close.svg"></md-icon>
            </md-button>
        </div>
        <md-content class="input-container layout-column ">
            {{messages[message_index].message_text}}
            <div class="layout-row layout-align-center-center" style="border-top: 2px solid black; padding-top: 6px"
                 ng-show="messages.length > 1">
                <div class="flex"></div>
                <md-button class="md-fab md-mini" style="background-color: rgb(48,48,48)"
                           ng-disabled="message_index == 0" ng-click="message_index = message_index - 1">
                    <md-icon md-svg-src="img/back.svg"></md-icon>
                </md-button>
                {{message_index + 1}} / {{messages.length}}
                <md-button class="md-fab md-mini" style="background-color: rgb(48,48,48)"
                           ng-disabled="message_index == messages.length - 1"
                           ng-click="message_index = message_index + 1">
                    <md-icon md-svg-src="img/next.svg"></md-icon>
                </md-button>
            </div>
        </md-content>
    </div>
</div>